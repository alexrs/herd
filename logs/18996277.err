Loaded module: cuda/11.6
Loaded dependency [python3/3.11.4]: gcc/12.3.0-binutils-2.40
Loaded dependency [python3/3.11.4]: sqlite3/3.42.0
Loaded module: python3/3.11.4

Loading python3/3.11.4
  Loading requirement: gcc/12.3.0-binutils-2.40 sqlite3/3.42.0
Found cached dataset parquet (/work3/s212722/herd/datasets/cache/alexrs___parquet/alexrs--alpaca-cleaned-30-clusters-a73d614e768ecc90/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7)
Loading cached processed dataset at /work3/s212722/herd/datasets/cache/alexrs___parquet/alexrs--alpaca-cleaned-30-clusters-a73d614e768ecc90/0.0.0/14a00e99c0d15a23649d0db8944380ac81082d4b021f398733dd84f3a6c569a7/cache-ca52bcb2493f34d6.arrow
2023-11-01 21:32:26.308 | INFO     | herd.finetune_utils:get_peft_config:30 - Fine-tuning with MoLoRA using 30 experts
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:03<00:03,  3.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  1.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:04<00:00,  2.15s/it]
2023-11-01 21:32:32.408 | WARNING  | herd.finetune:_finetune_experts:183 - Number of experts is not 1 but we are training an expert, setting it to 1. num_experts: 1
/zhome/03/c/164482/code/herd/.venv/lib/python3.11/site-packages/trl/trainer/utils.py:246: UserWarning: The passed formatting_func has more than one argument. Usually that function should have a single argument `example` which corresponds to the dictonnary returned by each element of the dataset. Make sure you know what you are doing.
  warnings.warn(
2023-11-01 21:33:05.996 | INFO     | herd.finetune:_finetune_experts:215 - Training expert: expert_20, output_dir: /work3/s212722/herd/meta-llama/Llama-2-7b-hf/alpaca-30/all_linear_paged_adam_4bit/molora/expert_20
wandb: Currently logged in as: alexrs95. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.12 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /zhome/03/c/164482/code/herd/wandb/run-20231101_213308-rplzfjgb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run molora/expert_20
wandb: ⭐️ View project at https://wandb.ai/alexrs95/herd-llama
wandb: 🚀 View run at https://wandb.ai/alexrs95/herd-llama/runs/rplzfjgb
  0%|          | 0/4488 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
  0%|          | 1/4488 [00:09<11:24:01,  9.15s/it]  0%|          | 2/4488 [00:15<9:00:40,  7.23s/it]   0%|          | 3/4488 [00:20<8:15:03,  6.62s/it]  0%|          | 4/4488 [00:26<7:53:42,  6.34s/it]  0%|          | 5/4488 [00:32<7:41:59,  6.18s/it]  0%|          | 6/4488 [00:38<7:34:55,  6.09s/it]  0%|          | 7/4488 [00:44<7:30:39,  6.03s/it]  0%|          | 8/4488 [00:50<7:27:55,  6.00s/it]  0%|          | 9/4488 [00:56<7:26:02,  5.98s/it]  0%|          | 10/4488 [01:02<7:24:45,  5.96s/it]                                                     0%|          | 10/4488 [01:02<7:24:45,  5.96s/it]  0%|          | 11/4488 [01:08<7:23:57,  5.95s/it]  0%|          | 12/4488 [01:14<7:23:26,  5.94s/it]  0%|          | 13/4488 [01:20<7:23:03,  5.94s/it]  0%|          | 14/4488 [01:26<7:22:45,  5.94s/it]  0%|          | 15/4488 [01:32<7:22:38,  5.94s/it]  0%|          | 16/4488 [01:37<7:22:33,  5.94s/it]  0%|          | 17/4488 [01:43<7:22:31,  5.94s/it]  0%|          | 18/4488 [01:49<7:22:28,  5.94s/it]  0%|          | 19/4488 [01:55<7:22:28,  5.94s/it]  0%|          | 20/4488 [02:01<7:22:23,  5.94s/it]                                                     0%|          | 20/4488 [02:01<7:22:23,  5.94s/it]  0%|          | 21/4488 [02:07<7:22:23,  5.94s/it]  0%|          | 22/4488 [02:13<7:22:18,  5.94s/it]  1%|          | 23/4488 [02:19<7:22:15,  5.94s/it]  1%|          | 24/4488 [02:25<7:22:05,  5.94s/it]  1%|          | 25/4488 [02:31<7:22:09,  5.94s/it]  1%|          | 26/4488 [02:37<7:22:06,  5.94s/it]  1%|          | 27/4488 [02:43<7:22:05,  5.95s/it]  1%|          | 28/4488 [02:49<7:21:52,  5.94s/it]  1%|          | 29/4488 [02:55<7:21:46,  5.94s/it]  1%|          | 30/4488 [03:01<7:21:40,  5.94s/it]                                                     1%|          | 30/4488 [03:01<7:21:40,  5.94s/it]  1%|          | 31/4488 [03:07<7:21:37,  5.95s/it]  1%|          | 32/4488 [03:13<7:21:36,  5.95s/it]  1%|          | 33/4488 [03:19<7:21:39,  5.95s/it]  1%|          | 34/4488 [03:24<7:21:35,  5.95s/it]  1%|          | 35/4488 [03:30<7:21:26,  5.95s/it]  1%|          | 36/4488 [03:36<7:21:19,  5.95s/it]  1%|          | 37/4488 [03:42<7:21:10,  5.95s/it]  1%|          | 38/4488 [03:48<7:21:04,  5.95s/it]  1%|          | 39/4488 [03:54<7:20:49,  5.95s/it]  1%|          | 40/4488 [04:00<7:20:43,  5.95s/it]                                                     1%|          | 40/4488 [04:00<7:20:43,  5.95s/it]  1%|          | 41/4488 [04:06<7:20:45,  5.95s/it]  1%|          | 42/4488 [04:12<7:20:36,  5.95s/it]  1%|          | 43/4488 [04:18<7:20:32,  5.95s/it]  1%|          | 44/4488 [04:24<7:20:23,  5.95s/it]  1%|          | 45/4488 [04:30<7:20:21,  5.95s/it]  1%|          | 46/4488 [04:36<7:20:15,  5.95s/it]  1%|          | 47/4488 [04:42<7:20:09,  5.95s/it]  1%|          | 48/4488 [04:48<7:20:05,  5.95s/it]  1%|          | 49/4488 [04:54<7:19:55,  5.95s/it]  1%|          | 50/4488 [05:00<7:19:49,  5.95s/it]                                                     1%|          | 50/4488 [05:00<7:19:49,  5.95s/it]  1%|          | 51/4488 [05:06<7:19:47,  5.95s/it]  1%|          | 52/4488 [05:11<7:19:44,  5.95s/it]  1%|          | 53/4488 [05:17<7:19:36,  5.95s/it]  1%|          | 54/4488 [05:23<7:19:31,  5.95s/it]  1%|          | 55/4488 [05:29<7:19:22,  5.95s/it]  1%|          | 56/4488 [05:35<7:19:18,  5.95s/it]  1%|▏         | 57/4488 [05:41<7:19:07,  5.95s/it]  1%|▏         | 58/4488 [05:47<7:19:05,  5.95s/it]  1%|▏         | 59/4488 [05:53<7:19:00,  5.95s/it]  1%|▏         | 60/4488 [05:59<7:18:49,  5.95s/it]                                                     1%|▏         | 60/4488 [05:59<7:18:49,  5.95s/it]  1%|▏         | 61/4488 [06:05<7:18:42,  5.95s/it]  1%|▏         | 62/4488 [06:11<7:18:41,  5.95s/it]  1%|▏         | 63/4488 [06:17<7:18:38,  5.95s/it]  1%|▏         | 64/4488 [06:23<7:18:31,  5.95s/it]  1%|▏         | 65/4488 [06:29<7:18:26,  5.95s/it]  1%|▏         | 66/4488 [06:35<7:18:20,  5.95s/it]  1%|▏         | 67/4488 [06:41<7:18:15,  5.95s/it]  2%|▏         | 68/4488 [06:47<7:18:02,  5.95s/it]  2%|▏         | 69/4488 [06:53<7:17:57,  5.95s/it]  2%|▏         | 70/4488 [06:59<7:17:54,  5.95s/it]                                                     2%|▏         | 70/4488 [06:59<7:17:54,  5.95s/it]  2%|▏         | 71/4488 [07:04<7:17:53,  5.95s/it]  2%|▏         | 72/4488 [07:10<7:17:42,  5.95s/it]  2%|▏         | 73/4488 [07:16<7:17:35,  5.95s/it]  2%|▏         | 74/4488 [07:22<7:17:21,  5.95s/it]  2%|▏         | 75/4488 [07:28<7:17:12,  5.94s/it]  2%|▏         | 76/4488 [07:34<7:17:10,  5.95s/it]  2%|▏         | 77/4488 [07:40<7:17:04,  5.95s/it]  2%|▏         | 78/4488 [07:46<7:16:55,  5.94s/it]  2%|▏         | 79/4488 [07:52<7:16:56,  5.95s/it]  2%|▏         | 80/4488 [07:58<7:16:55,  5.95s/it]                                                     2%|▏         | 80/4488 [07:58<7:16:55,  5.95s/it]  2%|▏         | 81/4488 [08:04<7:16:46,  5.95s/it]  2%|▏         | 82/4488 [08:10<7:16:38,  5.95s/it]  2%|▏         | 83/4488 [08:16<7:16:32,  5.95s/it]  2%|▏         | 84/4488 [08:22<7:16:33,  5.95s/it]  2%|▏         | 85/4488 [08:28<7:16:22,  5.95s/it]  2%|▏         | 86/4488 [08:34<7:16:20,  5.95s/it]  2%|▏         | 87/4488 [08:40<7:16:10,  5.95s/it]  2%|▏         | 88/4488 [08:46<7:16:06,  5.95s/it]  2%|▏         | 89/4488 [08:52<7:16:01,  5.95s/it]  2%|▏         | 90/4488 [08:57<7:15:55,  5.95s/it]                                                     2%|▏         | 90/4488 [08:57<7:15:55,  5.95s/it]  2%|▏         | 91/4488 [09:03<7:15:48,  5.95s/it]  2%|▏         | 92/4488 [09:09<7:15:45,  5.95s/it]  2%|▏         | 93/4488 [09:15<7:15:36,  5.95s/it]  2%|▏         | 94/4488 [09:21<7:15:25,  5.95s/it]  2%|▏         | 95/4488 [09:27<7:15:22,  5.95s/it]  2%|▏         | 96/4488 [09:33<7:15:19,  5.95s/it]  2%|▏         | 97/4488 [09:39<7:15:13,  5.95s/it]  2%|▏         | 98/4488 [09:45<7:15:03,  5.95s/it]  2%|▏         | 99/4488 [09:51<7:14:56,  5.95s/it]  2%|▏         | 100/4488 [09:57<7:14:46,  5.94s/it]                                                      2%|▏         | 100/4488 [09:57<7:14:46,  5.94s/it]  2%|▏         | 101/4488 [10:03<7:14:40,  5.95s/it]  2%|▏         | 102/4488 [10:09<7:14:34,  5.94s/it]  2%|▏         | 103/4488 [10:15<7:14:25,  5.94s/it]  2%|▏         | 104/4488 [10:21<7:14:20,  5.94s/it]  2%|▏         | 105/4488 [10:27<7:14:20,  5.95s/it]  2%|▏         | 106/4488 [10:33<7:14:14,  5.95s/it]  2%|▏         | 107/4488 [10:39<7:14:06,  5.95s/it]  2%|▏         | 108/4488 [10:44<7:13:56,  5.94s/it]  2%|▏         | 109/4488 [10:50<7:13:50,  5.94s/it]  2%|▏         | 110/4488 [10:56<7:13:45,  5.94s/it]                                                      2%|▏         | 110/4488 [10:56<7:13:45,  5.94s/it]  2%|▏         | 111/4488 [11:02<7:13:40,  5.94s/it]  2%|▏         | 112/4488 [11:08<7:13:44,  5.95s/it]  3%|▎         | 113/4488 [11:14<7:13:43,  5.95s/it]  3%|▎         | 114/4488 [11:20<7:13:33,  5.95s/it]  3%|▎         | 115/4488 [11:26<7:13:20,  5.95s/it]  3%|▎         | 116/4488 [11:32<7:13:18,  5.95s/it]  3%|▎         | 117/4488 [11:38<7:13:15,  5.95s/it]  3%|▎         | 118/4488 [11:44<7:13:06,  5.95s/it]  3%|▎         | 119/4488 [11:50<7:13:01,  5.95s/it]  3%|▎         | 120/4488 [11:56<7:12:53,  5.95s/it]                                                      3%|▎         | 120/4488 [11:56<7:12:53,  5.95s/it]  3%|▎         | 121/4488 [12:02<7:12:45,  5.95s/it]  3%|▎         | 122/4488 [12:08<7:12:40,  5.95s/it]  3%|▎         | 123/4488 [12:14<7:12:36,  5.95s/it]  3%|▎         | 124/4488 [12:20<7:12:32,  5.95s/it]  3%|▎         | 125/4488 [12:26<7:12:24,  5.95s/it]  3%|▎         | 126/4488 [12:32<7:12:12,  5.95s/it]  3%|▎         | 127/4488 [12:37<7:12:14,  5.95s/it]  3%|▎         | 128/4488 [12:43<7:12:14,  5.95s/it]  3%|▎         | 129/4488 [12:49<7:12:13,  5.95s/it]  3%|▎         | 130/4488 [12:55<7:12:06,  5.95s/it]                                                      3%|▎         | 130/4488 [12:55<7:12:06,  5.95s/it]  3%|▎         | 131/4488 [13:01<7:12:01,  5.95s/it]  3%|▎         | 132/4488 [13:07<7:11:51,  5.95s/it]  3%|▎         | 133/4488 [13:13<7:11:40,  5.95s/it]  3%|▎         | 134/4488 [13:19<7:11:33,  5.95s/it]  3%|▎         | 135/4488 [13:25<7:11:22,  5.95s/it]  3%|▎         | 136/4488 [13:31<7:11:13,  5.95s/it]  3%|▎         | 137/4488 [13:37<7:11:22,  5.95s/it]  3%|▎         | 138/4488 [13:43<7:11:21,  5.95s/it]  3%|▎         | 139/4488 [13:49<7:11:16,  5.95s/it]  3%|▎         | 140/4488 [13:55<7:11:08,  5.95s/it]                                                      3%|▎         | 140/4488 [13:55<7:11:08,  5.95s/it]  3%|▎         | 141/4488 [14:01<7:11:03,  5.95s/it]  3%|▎         | 142/4488 [14:07<7:10:49,  5.95s/it]  3%|▎         | 143/4488 [14:13<7:10:37,  5.95s/it]  3%|▎         | 144/4488 [14:19<7:10:30,  5.95s/it]  3%|▎         | 145/4488 [14:25<7:10:24,  5.95s/it]  3%|▎         | 146/4488 [14:30<7:10:13,  5.95s/it]  3%|▎         | 147/4488 [14:36<7:10:09,  5.95s/it]  3%|▎         | 148/4488 [14:42<7:10:03,  5.95s/it]  3%|▎         | 149/4488 [14:48<7:09:55,  5.95s/it]  3%|▎         | 150/4488 [14:54<7:09:52,  5.95s/it]                                                      3%|▎         | 150/4488 [14:54<7:09:52,  5.95s/it]  3%|▎         | 151/4488 [15:00<7:09:51,  5.95s/it]  3%|▎         | 152/4488 [15:06<7:09:36,  5.94s/it]  3%|▎         | 153/4488 [15:12<7:09:39,  5.95s/it]  3%|▎         | 154/4488 [15:18<7:09:28,  5.95s/it]  3%|▎         | 155/4488 [15:24<7:09:21,  5.95s/it]  3%|▎         | 156/4488 [15:30<7:09:17,  5.95s/it]  3%|▎         | 157/4488 [15:36<7:09:07,  5.94s/it]  4%|▎         | 158/4488 [15:42<7:09:06,  5.95s/it]  4%|▎         | 159/4488 [15:48<7:08:59,  5.95s/it]  4%|▎         | 160/4488 [15:54<7:08:54,  5.95s/it]                                                      4%|▎         | 160/4488 [15:54<7:08:54,  5.95s/it]  4%|▎         | 161/4488 [16:00<7:08:47,  5.95s/it]  4%|▎         | 162/4488 [16:06<7:08:44,  5.95s/it]  4%|▎         | 163/4488 [16:12<7:08:38,  5.95s/it]  4%|▎         | 164/4488 [16:18<7:08:30,  5.95s/it]  4%|▎         | 165/4488 [16:23<7:08:19,  5.94s/it]  4%|▎         | 166/4488 [16:29<7:08:21,  5.95s/it]  4%|▎         | 167/4488 [16:35<7:08:12,  5.95s/it]  4%|▎         | 168/4488 [16:41<7:08:05,  5.95s/it]  4%|▍         | 169/4488 [16:47<7:07:58,  5.95s/it]  4%|▍         | 170/4488 [16:53<7:07:58,  5.95s/it]                                                      4%|▍         | 170/4488 [16:53<7:07:58,  5.95s/it]  4%|▍         | 171/4488 [16:59<7:07:51,  5.95s/it]  4%|▍         | 172/4488 [17:05<7:07:43,  5.95s/it]  4%|▍         | 173/4488 [17:11<7:07:39,  5.95s/it]  4%|▍         | 174/4488 [17:17<7:07:35,  5.95s/it]  4%|▍         | 175/4488 [17:23<7:07:27,  5.95s/it]  4%|▍         | 176/4488 [17:29<7:07:23,  5.95s/it]  4%|▍         | 177/4488 [17:35<7:07:21,  5.95s/it]  4%|▍         | 178/4488 [17:41<7:07:14,  5.95s/it]  4%|▍         | 179/4488 [17:47<7:07:03,  5.95s/it]  4%|▍         | 180/4488 [17:53<7:06:53,  5.95s/it]                                                      4%|▍         | 180/4488 [17:53<7:06:53,  5.95s/it]  4%|▍         | 181/4488 [17:59<7:06:47,  5.95s/it]  4%|▍         | 182/4488 [18:05<7:06:48,  5.95s/it]  4%|▍         | 183/4488 [18:10<7:06:43,  5.95s/it]  4%|▍         | 184/4488 [18:16<7:06:40,  5.95s/it]  4%|▍         | 185/4488 [18:22<7:06:33,  5.95s/it]  4%|▍         | 186/4488 [18:28<7:06:27,  5.95s/it]  4%|▍         | 187/4488 [18:34<7:06:16,  5.95s/it]  4%|▍         | 188/4488 [18:40<7:06:06,  5.95s/it]  4%|▍         | 189/4488 [18:46<7:06:03,  5.95s/it]  4%|▍         | 190/4488 [18:52<7:05:55,  5.95s/it]                                                      4%|▍         | 190/4488 [18:52<7:05:55,  5.95s/it]  4%|▍         | 191/4488 [18:58<7:05:48,  5.95s/it]  4%|▍         | 192/4488 [19:04<7:05:40,  5.95s/it]  4%|▍         | 193/4488 [19:10<7:05:43,  5.95s/it]  4%|▍         | 194/4488 [19:16<7:05:37,  5.95s/it]  4%|▍         | 195/4488 [19:22<7:05:25,  5.95s/it]  4%|▍         | 196/4488 [19:28<7:05:20,  5.95s/it]  4%|▍         | 197/4488 [19:34<7:05:13,  5.95s/it]  4%|▍         | 198/4488 [19:40<7:05:04,  5.95s/it]  4%|▍         | 199/4488 [19:46<7:05:00,  5.95s/it]  4%|▍         | 200/4488 [19:52<7:04:49,  5.94s/it]                                                      4%|▍         | 200/4488 [19:52<7:04:49,  5.94s/it]  4%|▍         | 201/4488 [19:58<7:04:49,  5.95s/it]  5%|▍         | 202/4488 [20:03<7:04:37,  5.94s/it]  5%|▍         | 203/4488 [20:09<7:04:24,  5.94s/it]  5%|▍         | 204/4488 [20:15<7:04:27,  5.94s/it]  5%|▍         | 205/4488 [20:21<7:04:24,  5.95s/it]  5%|▍         | 206/4488 [20:27<7:04:15,  5.94s/it]  5%|▍         | 207/4488 [20:35<7:53:46,  6.64s/it]  5%|▍         | 208/4488 [20:41<7:38:43,  6.43s/it]  5%|▍         | 209/4488 [20:47<7:28:13,  6.29s/it]  5%|▍         | 210/4488 [20:53<7:20:50,  6.18s/it]                                                      5%|▍         | 210/4488 [20:53<7:20:50,  6.18s/it]  5%|▍         | 211/4488 [20:59<7:15:40,  6.11s/it]  5%|▍         | 212/4488 [21:05<7:12:02,  6.06s/it]  5%|▍         | 213/4488 [21:11<7:09:25,  6.03s/it]  5%|▍         | 214/4488 [21:17<7:07:33,  6.00s/it]  5%|▍         | 215/4488 [21:23<7:06:15,  5.99s/it]  5%|▍         | 216/4488 [21:29<7:05:24,  5.97s/it]  5%|▍         | 217/4488 [21:35<7:04:41,  5.97s/it]  5%|▍         | 218/4488 [21:41<7:04:05,  5.96s/it]  5%|▍         | 219/4488 [21:47<7:03:44,  5.96s/it]  5%|▍         | 220/4488 [21:53<7:03:28,  5.95s/it]                                                      5%|▍         | 220/4488 [21:53<7:03:28,  5.95s/it]  5%|▍         | 221/4488 [21:59<7:03:17,  5.95s/it]  5%|▍         | 222/4488 [22:05<7:03:01,  5.95s/it]  5%|▍         | 223/4488 [22:11<7:03:00,  5.95s/it]  5%|▍         | 224/4488 [22:17<7:02:49,  5.95s/it]  5%|▌         | 225/4488 [22:23<7:02:38,  5.95s/it]  5%|▌         | 226/4488 [22:28<7:02:34,  5.95s/it]  5%|▌         | 227/4488 [22:34<7:02:28,  5.95s/it]  5%|▌         | 228/4488 [22:40<7:02:18,  5.95s/it]  5%|▌         | 229/4488 [22:46<7:02:08,  5.95s/it]  5%|▌         | 230/4488 [22:52<7:02:07,  5.95s/it]                                                      5%|▌         | 230/4488 [22:52<7:02:07,  5.95s/it]  5%|▌         | 231/4488 [22:58<7:02:01,  5.95s/it]  5%|▌         | 232/4488 [23:04<7:01:50,  5.95s/it]  5%|▌         | 233/4488 [23:10<7:01:48,  5.95s/it]  5%|▌         | 234/4488 [23:16<7:01:39,  5.95s/it]  5%|▌         | 235/4488 [23:22<7:01:32,  5.95s/it]  5%|▌         | 236/4488 [23:28<7:01:23,  5.95s/it]  5%|▌         | 237/4488 [23:34<7:01:17,  5.95s/it]  5%|▌         | 238/4488 [23:40<7:01:15,  5.95s/it]  5%|▌         | 239/4488 [23:46<7:01:12,  5.95s/it]  5%|▌         | 240/4488 [23:52<7:01:11,  5.95s/it]                                                      5%|▌         | 240/4488 [23:52<7:01:11,  5.95s/it]  5%|▌         | 241/4488 [23:58<7:01:10,  5.95s/it]  5%|▌         | 242/4488 [24:04<7:00:55,  5.95s/it]  5%|▌         | 243/4488 [24:10<7:00:46,  5.95s/it]  5%|▌         | 244/4488 [24:16<7:00:41,  5.95s/it]  5%|▌         | 245/4488 [24:21<7:00:32,  5.95s/it]  5%|▌         | 246/4488 [24:27<7:00:21,  5.95s/it]  6%|▌         | 247/4488 [24:33<7:00:18,  5.95s/it]  6%|▌         | 248/4488 [24:39<7:00:13,  5.95s/it]  6%|▌         | 249/4488 [24:45<7:00:14,  5.95s/it]  6%|▌         | 250/4488 [24:51<7:00:08,  5.95s/it]                                                      6%|▌         | 250/4488 [24:51<7:00:08,  5.95s/it]  6%|▌         | 251/4488 [24:57<7:00:01,  5.95s/it]  6%|▌         | 252/4488 [25:03<6:59:54,  5.95s/it]  6%|▌         | 253/4488 [25:09<6:59:41,  5.95s/it]  6%|▌         | 254/4488 [25:15<6:59:38,  5.95s/it]  6%|▌         | 255/4488 [25:21<6:59:29,  5.95s/it]  6%|▌         | 256/4488 [25:27<6:59:25,  5.95s/it]  6%|▌         | 257/4488 [25:33<6:59:19,  5.95s/it]  6%|▌         | 258/4488 [25:39<6:59:10,  5.95s/it]  6%|▌         | 259/4488 [25:45<6:59:03,  5.95s/it]  6%|▌         | 260/4488 [25:51<6:58:58,  5.95s/it]                                                      6%|▌         | 260/4488 [25:51<6:58:58,  5.95s/it]  6%|▌         | 261/4488 [25:57<6:58:51,  5.95s/it]  6%|▌         | 262/4488 [26:03<6:58:49,  5.95s/it]  6%|▌         | 263/4488 [26:09<6:58:40,  5.95s/it]  6%|▌         | 264/4488 [26:14<6:58:31,  5.94s/it]  6%|▌         | 265/4488 [26:20<6:58:29,  5.95s/it]  6%|▌         | 266/4488 [26:26<6:58:20,  5.95s/it]  6%|▌         | 267/4488 [26:32<6:58:14,  5.95s/it]  6%|▌         | 268/4488 [26:38<6:58:12,  5.95s/it]  6%|▌         | 269/4488 [26:44<6:58:09,  5.95s/it]  6%|▌         | 270/4488 [26:50<6:58:04,  5.95s/it]                                                      6%|▌         | 270/4488 [26:50<6:58:04,  5.95s/it]  6%|▌         | 271/4488 [26:56<6:57:59,  5.95s/it]  6%|▌         | 272/4488 [27:02<6:57:49,  5.95s/it]  6%|▌         | 273/4488 [27:08<6:57:42,  5.95s/it]  6%|▌         | 274/4488 [27:14<6:57:42,  5.95s/it]  6%|▌         | 275/4488 [27:20<6:57:32,  5.95s/it]  6%|▌         | 276/4488 [27:26<6:57:22,  5.95s/it]  6%|▌         | 277/4488 [27:32<6:57:18,  5.95s/it]  6%|▌         | 278/4488 [27:38<6:57:08,  5.95s/it]  6%|▌         | 279/4488 [27:44<6:56:58,  5.94s/it]  6%|▌         | 280/4488 [27:50<6:56:56,  5.95s/it]                                                      6%|▌         | 280/4488 [27:50<6:56:56,  5.95s/it]  6%|▋         | 281/4488 [27:56<6:56:50,  5.94s/it]  6%|▋         | 282/4488 [28:01<6:56:41,  5.94s/it]  6%|▋         | 283/4488 [28:07<6:56:40,  5.95s/it]  6%|▋         | 284/4488 [28:13<6:56:39,  5.95s/it]  6%|▋         | 285/4488 [28:19<6:56:31,  5.95s/it]  6%|▋         | 286/4488 [28:25<6:56:24,  5.95s/it]  6%|▋         | 287/4488 [28:31<6:56:16,  5.95s/it]  6%|▋         | 288/4488 [28:37<6:56:04,  5.94s/it]  6%|▋         | 289/4488 [28:43<6:56:06,  5.95s/it]  6%|▋         | 290/4488 [28:49<6:56:01,  5.95s/it]                                                      6%|▋         | 290/4488 [28:49<6:56:01,  5.95s/it]  6%|▋         | 291/4488 [28:55<6:55:55,  5.95s/it]  7%|▋         | 292/4488 [29:01<6:55:47,  5.95s/it]  7%|▋         | 293/4488 [29:07<6:55:35,  5.94s/it]  7%|▋         | 294/4488 [29:13<6:55:27,  5.94s/it]  7%|▋         | 295/4488 [29:19<6:55:21,  5.94s/it]  7%|▋         | 296/4488 [29:25<6:55:17,  5.94s/it]  7%|▋         | 297/4488 [29:31<6:55:13,  5.94s/it]  7%|▋         | 298/4488 [29:37<6:55:08,  5.94s/it]  7%|▋         | 299/4488 [29:43<6:55:06,  5.95s/it]  7%|▋         | 300/4488 [29:48<6:54:55,  5.94s/it]                                                      7%|▋         | 300/4488 [29:48<6:54:55,  5.94s/it]  7%|▋         | 301/4488 [29:54<6:54:53,  5.95s/it]  7%|▋         | 302/4488 [30:00<6:54:46,  5.95s/it]  7%|▋         | 303/4488 [30:06<6:54:43,  5.95s/it]  7%|▋         | 304/4488 [30:12<6:54:37,  5.95s/it]  7%|▋         | 305/4488 [30:18<6:54:31,  5.95s/it]  7%|▋         | 306/4488 [30:24<6:54:25,  5.95s/it]  7%|▋         | 307/4488 [30:30<6:54:14,  5.94s/it]  7%|▋         | 308/4488 [30:36<6:54:09,  5.94s/it]  7%|▋         | 309/4488 [30:42<6:53:59,  5.94s/it]  7%|▋         | 310/4488 [30:48<6:53:54,  5.94s/it]                                                      7%|▋         | 310/4488 [30:48<6:53:54,  5.94s/it]  7%|▋         | 311/4488 [30:54<6:53:52,  5.95s/it]  7%|▋         | 312/4488 [31:00<6:53:45,  5.94s/it]  7%|▋         | 313/4488 [31:06<6:53:39,  5.94s/it]  7%|▋         | 314/4488 [31:12<6:53:32,  5.94s/it]  7%|▋         | 315/4488 [31:18<6:53:29,  5.95s/it]  7%|▋         | 316/4488 [31:24<6:53:20,  5.94s/it]  7%|▋         | 317/4488 [31:30<6:53:19,  5.95s/it]  7%|▋         | 318/4488 [31:36<6:53:16,  5.95s/it]  7%|▋         | 319/4488 [31:41<6:53:08,  5.95s/it]  7%|▋         | 320/4488 [31:47<6:53:00,  5.95s/it]                                                      7%|▋         | 320/4488 [31:47<6:53:00,  5.95s/it]  7%|▋         | 321/4488 [31:53<6:52:55,  5.95s/it]  7%|▋         | 322/4488 [31:59<6:52:44,  5.94s/it]  7%|▋         | 323/4488 [32:05<6:52:45,  5.95s/it]  7%|▋         | 324/4488 [32:11<6:52:34,  5.94s/it]  7%|▋         | 325/4488 [32:17<6:52:24,  5.94s/it]  7%|▋         | 326/4488 [32:23<6:52:23,  5.95s/it]  7%|▋         | 327/4488 [32:29<6:52:19,  5.95s/it]  7%|▋         | 328/4488 [32:35<6:52:10,  5.94s/it]  7%|▋         | 329/4488 [32:41<6:52:01,  5.94s/it]  7%|▋         | 330/4488 [32:47<6:51:57,  5.94s/it]                                                      7%|▋         | 330/4488 [32:47<6:51:57,  5.94s/it]  7%|▋         | 331/4488 [32:53<6:51:54,  5.95s/it]  7%|▋         | 332/4488 [32:59<6:51:47,  5.95s/it]  7%|▋         | 333/4488 [33:05<6:51:38,  5.94s/it]  7%|▋         | 334/4488 [33:11<6:51:31,  5.94s/it]  7%|▋         | 335/4488 [33:17<6:51:24,  5.94s/it]  7%|▋         | 336/4488 [33:23<6:51:21,  5.94s/it]  8%|▊         | 337/4488 [33:28<6:51:12,  5.94s/it]  8%|▊         | 338/4488 [33:34<6:51:11,  5.95s/it]  8%|▊         | 339/4488 [33:40<6:51:03,  5.94s/it]  8%|▊         | 340/4488 [33:46<6:51:00,  5.95s/it]                                                      8%|▊         | 340/4488 [33:46<6:51:00,  5.95s/it]  8%|▊         | 341/4488 [33:52<6:50:51,  5.94s/it]  8%|▊         | 342/4488 [33:58<6:50:43,  5.94s/it]  8%|▊         | 343/4488 [34:04<6:50:44,  5.95s/it]  8%|▊         | 344/4488 [34:10<6:50:34,  5.94s/it]  8%|▊         | 345/4488 [34:16<6:50:27,  5.94s/it]  8%|▊         | 346/4488 [34:22<6:50:17,  5.94s/it]  8%|▊         | 347/4488 [34:28<6:50:08,  5.94s/it]  8%|▊         | 348/4488 [34:34<6:50:00,  5.94s/it]  8%|▊         | 349/4488 [34:40<6:49:54,  5.94s/it]  8%|▊         | 350/4488 [34:46<6:49:51,  5.94s/it]                                                      8%|▊         | 350/4488 [34:46<6:49:51,  5.94s/it]  8%|▊         | 351/4488 [34:52<6:49:46,  5.94s/it]  8%|▊         | 352/4488 [34:58<6:49:38,  5.94s/it]  8%|▊         | 353/4488 [35:04<6:49:31,  5.94s/it]  8%|▊         | 354/4488 [35:10<6:49:28,  5.94s/it]  8%|▊         | 355/4488 [35:15<6:49:27,  5.94s/it]  8%|▊         | 356/4488 [35:21<6:49:21,  5.94s/it]  8%|▊         | 357/4488 [35:27<6:49:14,  5.94s/it]  8%|▊         | 358/4488 [35:33<6:49:06,  5.94s/it]  8%|▊         | 359/4488 [35:39<6:49:03,  5.94s/it]  8%|▊         | 360/4488 [35:45<6:48:56,  5.94s/it]                                                      8%|▊         | 360/4488 [35:45<6:48:56,  5.94s/it]  8%|▊         | 361/4488 [35:51<6:48:50,  5.94s/it]  8%|▊         | 362/4488 [35:57<6:48:44,  5.94s/it]  8%|▊         | 363/4488 [36:03<6:48:40,  5.94s/it]  8%|▊         | 364/4488 [36:09<6:48:35,  5.94s/it]  8%|▊         | 365/4488 [36:15<6:48:30,  5.94s/it]  8%|▊         | 366/4488 [36:21<6:48:22,  5.94s/it]  8%|▊         | 367/4488 [36:27<6:48:17,  5.94s/it]  8%|▊         | 368/4488 [36:33<6:48:05,  5.94s/it]  8%|▊         | 369/4488 [36:39<6:48:00,  5.94s/it]  8%|▊         | 370/4488 [36:45<6:47:54,  5.94s/it]                                                      8%|▊         | 370/4488 [36:45<6:47:54,  5.94s/it]  8%|▊         | 371/4488 [36:51<6:47:46,  5.94s/it]  8%|▊         | 372/4488 [36:56<6:47:40,  5.94s/it]  8%|▊         | 373/4488 [37:02<6:47:39,  5.94s/it]  8%|▊         | 374/4488 [37:08<6:47:29,  5.94s/it]  8%|▊         | 375/4488 [37:14<6:47:27,  5.94s/it]  8%|▊         | 376/4488 [37:20<6:47:22,  5.94s/it]  8%|▊         | 377/4488 [37:26<6:47:16,  5.94s/it]  8%|▊         | 378/4488 [37:32<6:47:12,  5.94s/it]  8%|▊         | 379/4488 [37:38<6:47:02,  5.94s/it]  8%|▊         | 380/4488 [37:44<6:46:58,  5.94s/it]                                                      8%|▊         | 380/4488 [37:44<6:46:58,  5.94s/it]  8%|▊         | 381/4488 [37:50<6:46:55,  5.94s/it]  9%|▊         | 382/4488 [37:56<6:46:47,  5.94s/it]  9%|▊         | 383/4488 [38:02<6:46:41,  5.94s/it]  9%|▊         | 384/4488 [38:08<6:46:31,  5.94s/it]  9%|▊         | 385/4488 [38:14<6:46:29,  5.94s/it]  9%|▊         | 386/4488 [38:20<6:46:19,  5.94s/it]  9%|▊         | 387/4488 [38:26<6:46:11,  5.94s/it]  9%|▊         | 388/4488 [38:32<6:46:09,  5.94s/it]  9%|▊         | 389/4488 [38:38<6:46:00,  5.94s/it]  9%|▊         | 390/4488 [38:43<6:45:59,  5.94s/it]                                                      9%|▊         | 390/4488 [38:43<6:45:59,  5.94s/it]  9%|▊         | 391/4488 [38:49<6:45:50,  5.94s/it]  9%|▊         | 392/4488 [38:55<6:45:40,  5.94s/it]  9%|▉         | 393/4488 [39:01<6:45:32,  5.94s/it]  9%|▉         | 394/4488 [39:07<6:45:29,  5.94s/it]  9%|▉         | 395/4488 [39:13<6:45:28,  5.94s/it]  9%|▉         | 396/4488 [39:19<6:45:19,  5.94s/it]  9%|▉         | 397/4488 [39:25<6:45:19,  5.94s/it]  9%|▉         | 398/4488 [39:31<6:45:07,  5.94s/it]  9%|▉         | 399/4488 [39:37<6:45:05,  5.94s/it]  9%|▉         | 400/4488 [39:43<6:44:56,  5.94s/it]                                                      9%|▉         | 400/4488 [39:43<6:44:56,  5.94s/it]  9%|▉         | 401/4488 [39:49<6:44:49,  5.94s/it]  9%|▉         | 402/4488 [39:55<6:44:42,  5.94s/it]  9%|▉         | 403/4488 [40:01<6:44:39,  5.94s/it]  9%|▉         | 404/4488 [40:07<6:44:33,  5.94s/it]  9%|▉         | 405/4488 [40:13<6:44:31,  5.94s/it]  9%|▉         | 406/4488 [40:19<6:44:27,  5.94s/it]  9%|▉         | 407/4488 [40:25<6:44:20,  5.94s/it]  9%|▉         | 408/4488 [40:30<6:44:13,  5.94s/it]  9%|▉         | 409/4488 [40:36<6:44:04,  5.94s/it]  9%|▉         | 410/4488 [40:42<6:44:01,  5.94s/it]                                                      9%|▉         | 410/4488 [40:42<6:44:01,  5.94s/it]  9%|▉         | 411/4488 [40:48<6:43:56,  5.94s/it]  9%|▉         | 412/4488 [40:54<6:43:49,  5.94s/it]  9%|▉         | 413/4488 [41:00<6:44:24,  5.95s/it]                                                      9%|▉         | 413/4488 [41:01<6:44:24,  5.95s/it]  9%|▉         | 413/4488 [41:01<6:44:43,  5.96s/it]
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:                    train/epoch ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▇▇▇█████████████████
wandb:              train/global_step ▁▁▁▂▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇███
wandb:            train/learning_rate ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                     train/loss ▇█▇▇▇▇▇▇██▇▇▇▇▇███▇▇▆▁▁▁▁▂▂▂▂▂▂▂▃▃▃▄▄▃▃▃
wandb:               train/total_flos ▁
wandb:               train/train_loss ▁
wandb:            train/train_runtime ▁
wandb: train/train_samples_per_second ▁
wandb:   train/train_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    train/epoch 1.09
wandb:              train/global_step 413
wandb:            train/learning_rate 0.0003
wandb:                     train/loss 0.714
wandb:               train/total_flos 1.345564766848942e+17
wandb:               train/train_loss 0.7815
wandb:            train/train_runtime 2463.6927
wandb: train/train_samples_per_second 7.287
wandb:   train/train_steps_per_second 1.822
wandb: 
wandb: 🚀 View run molora/expert_20 at: https://wandb.ai/alexrs95/herd-llama/runs/rplzfjgb
wandb: ️⚡ View job at https://wandb.ai/alexrs95/herd-llama/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjk5NjEyNzE2/version_details/v15
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20231101_213308-rplzfjgb/logs
